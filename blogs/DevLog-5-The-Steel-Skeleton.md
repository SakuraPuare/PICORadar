# DevLog #5: 铸造项目的钢铁骨架：CI/CD与代码规范

大家好，我是书樱！

在过去的几篇日志里，我们一直在冲锋陷阵：搭建网络服务器、实现鉴权逻辑、修复棘手的构建问题……我们的PICO Radar项目已经从一个概念，成长为一个可以运行、可以连接的程序。它已经有了“血肉”。

但是，一个生物若想走得远、跑得快，仅仅有血肉是不够的，它必须拥有一副强健的骨架。在软件工程的世界里，这副“钢铁骨架”就是我们的开发规范、工作流和自动化工具。

所以，在继续开发核心的数据广播功能之前，我们决定暂停一下，回头为我们的项目“铸造骨架”。

## 第一根支柱：代码的统一语言 (`clang-format` & `clang-tidy`)

你是否曾陷入过关于“大括号是否要换行”的“圣战”？或者因为一个不经意的`NULL`指针导致了数小时的调试？为了避免这些，我们引入了两位强大的“规则制定者”：

*   **`clang-format`**: 我们的“首席造型师”。我们为它配置了业界广泛认可的“Google C++风格指南”。从此，无论是谁写的代码，在提交前都会被自动格式化成同一种风格。代码库就像穿上了统一的制服，整洁、专业、赏心悦目。
*   **`clang-tidy`**: 我们不知疲倦的“代码审查员”。它像一位经验丰富的前辈，审视着我们的每一行代码，不仅能找出潜在的bug（`bugprone-*`）、性能陷阱（`performance-*`），还能引导我们使用更现代的C++写法（`modernize-*`）。最棒的是，它不仅提出问题，还能自动“修复”大部分它发现的问题！

## 第二根支柱：严格的本地门卫 (`pre-commit`)

有了规则，如何确保每个人都遵守呢？答案是自动化。我们引入了`pre-commit`，一个通用且强大的Git钩子框架。

我喜欢把它想象成我们代码仓库的“本地门卫”。在我们为项目配置好它之后，每当开发者试图`git commit`提交代码时，这位“门卫”就会被激活。它会拦下所有代码，并自动运行`clang-format`和`clang-tidy`进行检查和格式化。

只有通过了所有检查的代码，才被允许进入仓库。这从源头上保证了我们代码库的纯净与高质量。

## 第三根支柱：公正的云端守护者 (GitHub Actions CI/CD)

本地的“门卫”保证了个人提交的质量，但我们还需要一个更高层次的保障。万一有人绕过了本地检查，或者在不同的操作系统上出现了意想不到的问题怎么办？

为此，我们建立了项目的“云端守护者”——一个基于GitHub Actions的持续集成（CI）工作流。

这个工作流就像一个标准化的、中立的测试场。每当有新的代码被推送到主分支或发起合并请求时，这位“守护者”就会被唤醒。它会在一个全新的、纯净的云端服务器上，执行一整套严格的流程：
1.  拉取最新代码。
2.  使用`vcpkg`安装所有依赖。
3.  从零开始编译整个项目。
4.  运行我们所有的单元测试。

只有当所有步骤都成功通过，CI流程才会显示为“绿色通过”。这给了我们极大的信心，确保了无论何时，我们主分支上的代码都一定是可编译、可测试、可工作的。

## 骨架已成，准备奔跑

现在，PICO Radar项目终于拥有了一副钢铁骨架。这套由代码规范、本地自动化和云端CI/CD组成的体系，将成为我们未来快速、安全开发新功能的坚实基础。

我们为基础设施投入的这些时间，是绝对值得的。现在，我们可以安心地回到我们的核心使命上了。

下一站：**实现数据广播循环**！让所有玩家真正地在虚拟世界中“看到”彼此。

感谢您的关注，我们很快再见！

---
书樱
2025年7月21日